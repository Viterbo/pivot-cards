<ion-header>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <pivot-back-btn (click)="app.history.back();"></pivot-back-btn>
            <pivot-header [page]="page" [delegate]="false"></pivot-header>
        </div>
    </nav>
</ion-header> 

<ion-content [fullscreen]="true">

    <div class="container">

        <ion-grid class="flex-grow">

            <!-- bienvenida -->
            <ion-row class="ion-padding">
                <ion-col>
                    <h1>Dinámica de Flitros</h1>
                    <p>En esta propuesta podrás filtrar las cartas según unos criterios que hemos preparado para y así conseguir un subconjunto de cartas que mejor se adapten a tu negocio, con las que ṕodrás trabajar posteriormente sobre el canvas para crear un modelo de negocio innovador relacionado con <strong>{{deck.industria}}</strong>.</p>
                    <p><strong>Cambia las opciones del formulario</strong> para aplicar diferentes <strong>filtros</strong> sobre las cartas.</p>
                </ion-col>
            </ion-row>

            <ion-row class="ion-padding-vertical">
                <ion-col size="2"></ion-col>
                <ion-col size="8">
                    <ion-item>
                        <ion-label position="floating">Producto o Servicio</ion-label>
                        <ion-input ngDefaultControl [(ngModel)]="deck.industria" (keyup)="deck.updatePitch()"></ion-input>
                    </ion-item>
                </ion-col>
                <ion-col size="2"></ion-col>
            </ion-row>
        
            <!-- formulario -->
            <ion-row class="ion-padding-horizontal" *ngFor="let q of deck.filters; let n = index">
                <ion-col size="8" class="no-padding d-flex ion-align-self-center ion-justify-content-start ion-text-left">
                    <span>{{q.text}}:</span>
                </ion-col>
                <ion-col size="4" class="no-padding d-flex flex-column ion-align-self-center ion-justify-content-end ion-text-right">
                    <form>
                        <mat-form-field appearance="fill" class="no-padding d-block">
                            <mat-select (selectionChange)="onSelectionChange(n,$event)">
                                <mat-option *ngFor="let opt of q.options; let i = index" value="{{i}}">{{opt.text}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </form>
                </ion-col>
            </ion-row>  
            
            <!-- goto canvas -->
            <ion-row class="counter flex-grow ion-margin-vertical">
                <ion-col class="ion-text-left ion-align-items-end d-flex">
                    <span [hidden]="deck.selection.length != 0">Debes seleccionar al menos una carta de cada color</span>
                    <span [hidden]="deck.selection.length == 0">Has seleccionado {{deck.selection.length}} {{deck.selection.length == 1 ? 'carta' : 'cartas'}} </span>
                </ion-col>
                <ion-col class="ion-text-right">
                    <button mat-raised-button color="accent" (click)="clearAll()">
                        Limpiar
                        <i class="material-icons">delete</i>
                    </button>
                    &nbsp;
                    <button mat-raised-button [disabled]="!showGoToCanvas" color="primary" (click)="goToCanvas()">
                        Canvas
                        <i class="material-icons">navigate_next</i>
                    </button>
                </ion-col>
            </ion-row>

            <pivot-counter [deck]="deck.selection" (oninit)="onCounterInit($event)"></pivot-counter>

            <!-- Seleccion -->
            <ion-row *ngIf="counter" class="no-padding slots flex-grow ion-align-items-start ion-justify-content-start ion-margin-top">
                <ion-col>
                    <pivot-label-btn color="red"></pivot-label-btn>
                    <color-card-list
                        color="red"
                        [deck]="deck.selection"
                        (oninit)="onListReady('red', $event)"
                        (onclick)="onCardClick($event)"
                    ></color-card-list>
                </ion-col>
                <ion-col>
                    <pivot-label-btn color="blue"></pivot-label-btn>
                    <color-card-list
                        color="blue"
                        [deck]="deck.selection"
                        (oninit)="onListReady('blue', $event)"
                        (onclick)="onCardClick($event)"
                    ></color-card-list>
                </ion-col>
                <ion-col>
                    <pivot-label-btn color="green"></pivot-label-btn>
                    <color-card-list
                        color="green"
                        [deck]="deck.selection"
                        (oninit)="onListReady('green', $event)"
                        (onclick)="onCardClick($event)"
                    ></color-card-list>
                </ion-col>
                <ion-col>
                    <pivot-label-btn color="yellow"></pivot-label-btn>
                    <color-card-list
                        color="yellow"
                        [deck]="deck.selection"
                        (oninit)="onListReady('yellow', $event)"
                        (onclick)="onCardClick($event)"
                    ></color-card-list>
                </ion-col>                                                
            </ion-row>
            
            
        </ion-grid>

    </div>

</ion-content>